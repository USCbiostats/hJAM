---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```
# hJAM

<!-- badges: start -->
[![R build status](https://github.com/lailylajiang/hJAM/workflows/R-CMD-check/badge.svg)](https://github.com/lailylajiang/hJAM)
<!-- badges: end -->

<!-- CRAN badges: start -->
[![CRAN_Status_Badge](http://www.r-pkg.org/badges/version/hJAM)](https://CRAN.R-project.org/package=hJAM)[![Downloads](http://cranlogs.r-pkg.org/badges/grand-total/hJAM)](https://CRAN.R-project.org/package=hJAM)
<!-- CRAN badges: end -->

hJAM is a hierarchical model which unifies the framework of Mendelian Randomization and Transcriptome-wide association studies.

## Installation

You can install the published version of hJAM from CRAN with:

``` r
install.packages("hJAM")
```

Or you can install the development version from [GitHub](https://github.com/lailylajiang/hJAM) with:

``` r
if (!require("devtools")) { install.packages("devtools") } else {}
devtools::install_github("lailylajiang/hJAM")
```
## Example

This is a basic example of fitting hJAM model:

```{r example}
library(hJAM)
# Download the data for data example 2 from the package
data(MI)
```
## Data and functions import

A quick look at the data in the example - 

```{r data_check}
MI.Amatrix[1:5, ]
MI.betas.gwas[1:5]
MI.SNPs_info[1:5, ]
```

```{r Amatrix}
MI.cond_A = JAM_A(marginalA = MI.marginal.Amatrix, Geno = MI.Geno, N.Gx = c(339224, 659316), ridgeTerm = TRUE)
MI.cond_A[1:5, ]
MI.Amatrix[1:5, ]
```

```{r hjam_lnreg}
hJAM::hJAM(betas.Gy = MI.betas.gwas, N.Gy = 459324, A = MI.Amatrix, 
                 Gl = MI.Geno, ridgeTerm = TRUE) # 459324 is the sample size of the UK Biobank GWAS of MI
```
